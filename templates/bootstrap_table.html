{% extends "base.html" %}

{% block content %}
  <table id="data" class="table table-borderless table-dark">
    <thead>
      <tr>
        <th>File name</th>
        <th>Date uploaded</th>
      </tr>
    </thead>
    <tbody>
      {% for entry in uploads %}
        <tr>
          <td>{{ entry.name }}</td>
          <td>{{ entry.time }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <form id='form' hx-encoding='multipart/form-data' hx-post='{{ url_for("upload_file") }}' hx-trigger="submit">
    <input type='file' name='file'>
    <button hx-get="#data" hx-indicator="#progress" hx-target="#data" hx-swap="outerHTML" >
      Upload
    </button>
    <progress id='progress' value='0' max='100'></progress>
  </form>

  <script>
    htmx.on('#form', 'htmx:xhr:progress', function(evt) {
      htmx.find('#progress').setAttribute('value', evt.detail.loaded/evt.detail.total * 100)
    });
  </script>
{% endblock %}
